---
title: "Mini-Project 2"
author: "Kerry LeCure, Libby Leung, Madeleine Hickman"
date: "October 31, 2017"
output: html_document
---

```{r, message=FALSE}
library(tidyverse)
library(RColorBrewer)
load("house_elections.rda")
load("candidates.rda")
load("committees.rda")
load("contributions.rda")
```
```{r}
#use of full_join via cand_id to join candidates data set with contributions dataset in order to include party affiliation with the data
data <- full_join(candidates, contributions, by = c("cand_id"))
data <- data %>%
  select("cand_party_affiliation", "entity_type") %>% #we determined that these were going to be necessary for what we were looking for
  filter(entity_type == c("CCM", "CAN", "COM", "IND", "ORG", "PAC", "PTY"), !is.na(c("entity_type", "transaction_type", "transaction_amt", "cand_party_affiliation"))) %>% #we filtered out entity types that did not have a known value per the FEC (i.e. a category that did not have a name)
  group_by(cand_party_affiliation) %>%
  count(entity_type) #this was done done in order to count how many times the entity_type occurred per party
data
```
```{r}
#function to generalize analysis
party <- function(party_id) {
  data %>%
    filter(cand_party_affiliation == party_id) %>%
    group_by(entity_type) %>%
    summarize(total_entity = n()) %>%
    arrange(desc(total_entity))
}
party(party_id = "DEM")
party(party_id = "REP")

entity <- function(entities) {
  data %>%
    filter(entity_type == entities) %>%
    group_by(cand_party_affiliation) %>%
    summarize(total_party = n()) %>%
    arrange(desc(total_party))
}
entity(entities = "CCM")
```
```{r}
ggplot(data, aes(x = cand_party_affiliation, y = n, fill = entity_type)) +
  geom_bar(stat = "identity", position = "dodge") +
  xlab("Political Party") +
  ylab("Number of times an entity contributed") +
  guides(fill = guide_legend(title = "Type of Entity")) +
  scale_fill_brewer(palette = "Set1")
```

This graph displays the number of times that a donation was made from various types of entities. 
The function `party` sorts the data by `cand_party_affiliation` and shows the amount of times each specific entity (such as an organization or a committee) contributed to a specified party. The function `entities` sorts the data by `entity_type` and will show how many times a each party recieved a contribution from a specified entity.
The data graph illustrates each political party and the amount of entities that contributed to the party. Based on looking at the graphic it is apparent that most entities contribute to the two most popular parties, the Republicans and Democrats. To clarify each entity type, can are the candidates themselves, ccm represents a candidate committee, com is a committee, ind is the individual who is contributing, org is the organization who is not a person or part of a committee, pac is the political action committee, and pty is the party organization. Other political parties have very few or none contributions from any of the entity types. This may be because they are not widely known by the public or do not have any affiliations with any committee or organization that is willing to contribute any money to the political party. However, it is refreshing to see that there are other political parties out there besides to the two most known. Parties such as DFL, IND, and NA have contributions but not as much as the democrats and the republicans. This might be the cause to why they do not do so well during the election period.

Most entity types contribute most of their money to the Republicans and Democrats. Each candidate contributed the same amount of times. However, when comparing the candidate committees, the republicans increased the democrats by 3000 times. This is because many wealthy committees have views that are on the left side of politics. Therefore they favor the Republican Party and are willing to contribute a large portion of money to help them during the election process.  In addition, the Republican Party has about 1500 more times the amount of entity contributions from committees than the democrats. The reasoning behind this is the same as why so many candidate committees contribute to the republicans. Since the many committees on the republican side are wealthier than the democrats, the data proves that more republicans have a larger portion of committee contributions. In contrast the number of individuals contributed to the democrats was more than the republicans. This may of happen because many middle and lower class income families and the younger generation are sided with the Democratic Party. As a result, a person from the family or a millennial will contribute to the democrats. While, people who side with the Republicans are usually in big groups and therefore not as many individuals will donate. For both of the two parties, the amount of times an organization and a party organization were the similar. There are many different types of organizations that side with either the democrats or the republicans, so much so they are about the same. 
